# è´­ç‰©è½¦æ¨¡å—ä½¿ç”¨è¯´æ˜

## ğŸ“¦ æ¨¡å—æ¦‚è¿°

è´­ç‰©è½¦æ¨¡å—å·²å®Œæˆå¼€å‘ï¼ŒåŒ…å«å‰åç«¯å®Œæ•´å®ç°ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åç«¯å¯åŠ¨

1. ç¡®ä¿æ•°æ®åº“å·²åˆ›å»ºå¹¶åˆå§‹åŒ–ï¼ˆå‚è€ƒ `docs/hwmall_db.sql`ï¼‰
2. æ£€æŸ¥ `application.yml` ä¸­çš„æ•°æ®åº“é…ç½®
3. å¯åŠ¨ Spring Boot åº”ç”¨ï¼š
   ```bash
   cd service/hwMallServicedemo
   mvn spring-boot:run
   ```
4. åç«¯æœåŠ¡è¿è¡Œåœ¨ `http://localhost:8080`

### å‰ç«¯å¯åŠ¨

1. å®‰è£…ä¾èµ–ï¼š
   ```bash
   cd web/HwMall
   npm install
   ```
2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
   ```bash
   npm run dev
   ```
3. å‰ç«¯æœåŠ¡è¿è¡Œåœ¨ `http://localhost:5173`ï¼ˆVite é»˜è®¤ç«¯å£ï¼‰

## ğŸ“ æ–‡ä»¶ç»“æ„

### åç«¯æ–‡ä»¶

```
service/hwMallServicedemo/src/main/java/com/peng/hwmallservicedemo/
â”œâ”€â”€ model/cart/
â”‚   â”œâ”€â”€ Cart.java          # è´­ç‰©è½¦å®ä½“ç±»
â”‚   â””â”€â”€ CartVO.java        # è´­ç‰©è½¦è§†å›¾å¯¹è±¡
â”œâ”€â”€ repository/cart/
â”‚   â””â”€â”€ CartRepository.java  # æ•°æ®è®¿é—®æ¥å£
â”œâ”€â”€ service/cart/
â”‚   â”œâ”€â”€ CartService.java      # æœåŠ¡æ¥å£
â”‚   â””â”€â”€ CartServiceImpl.java  # æœåŠ¡å®ç°
â””â”€â”€ controller/cart/
    â””â”€â”€ CartController.java   # æ§åˆ¶å™¨

service/hwMallServicedemo/src/main/resources/
â”œâ”€â”€ mappers/
â”‚   â”œâ”€â”€ cartmapper.xml     # è´­ç‰©è½¦ MyBatis Mapper
â”‚   â””â”€â”€ productmapper.xml  # å•†å“ MyBatis Mapperï¼ˆè´­ç‰©è½¦ä¾èµ–ï¼‰
â””â”€â”€ mybatis.xml            # MyBatis é…ç½®ï¼ˆå·²æ›´æ–°ï¼‰
```

### å‰ç«¯æ–‡ä»¶

```
web/HwMall/src/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ request.js         # Axios è¯·æ±‚å°è£…
â”‚   â””â”€â”€ cart.js            # è´­ç‰©è½¦ API
â”œâ”€â”€ components/Cart/
â”‚   â”œâ”€â”€ Cart.vue           # è´­ç‰©è½¦ä¸»ç»„ä»¶
â”‚   â””â”€â”€ CartItem.vue       # è´­ç‰©è½¦å•†å“é¡¹ç»„ä»¶
â”œâ”€â”€ views/Cart/
â”‚   â””â”€â”€ CartView.vue       # è´­ç‰©è½¦é¡µé¢
â””â”€â”€ router/
    â””â”€â”€ index.js           # è·¯ç”±é…ç½®
```

## ğŸ”Œ API æ¥å£

### 1. æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
- **URL:** `POST /api/cart/add`
- **è¯·æ±‚ä½“:**
  ```json
  {
    "userId": 1,
    "productId": 1,
    "quantity": 1
  }
  ```
- **å“åº”:**
  ```json
  {
    "code": 200,
    "message": "æ·»åŠ æˆåŠŸ",
    "data": {
      "cartCount": 5
    }
  }
  ```

### 2. è·å–è´­ç‰©è½¦åˆ—è¡¨
- **URL:** `GET /api/cart/list?userId=1`
- **å“åº”:**
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "cartItems": [
        {
          "cartId": 1,
          "productId": 1,
          "productName": "å•†å“åç§°",
          "price": 99.99,
          "quantity": 2,
          "stock": 100,
          "subtotal": 199.98
        }
      ],
      "totalAmount": 199.98
    }
  }
  ```

### 3. æ›´æ–°è´­ç‰©è½¦å•†å“æ•°é‡
- **URL:** `PUT /api/cart/update`
- **è¯·æ±‚ä½“:**
  ```json
  {
    "cartId": 1,
    "quantity": 3
  }
  ```

### 4. åˆ é™¤è´­ç‰©è½¦å•†å“
- **URL:** `DELETE /api/cart/delete/{cartId}`

### 5. æ¸…ç©ºè´­ç‰©è½¦
- **URL:** `DELETE /api/cart/clear?userId=1`

### 6. è·å–è´­ç‰©è½¦å•†å“æ•°é‡
- **URL:** `GET /api/cart/count?userId=1`

## ğŸ’» å‰ç«¯ä½¿ç”¨

### è®¿é—®è´­ç‰©è½¦é¡µé¢

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š`http://localhost:5173/cart`

### åœ¨ä»£ç ä¸­ä½¿ç”¨

```javascript
import { addToCart, getCartList } from '@/api/cart.js'

// æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
await addToCart(1, 1, 2) // userId, productId, quantity

// è·å–è´­ç‰©è½¦åˆ—è¡¨
const response = await getCartList(1) // userId
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç”¨æˆ·IDè·å–**ï¼šå½“å‰å®ç°ä» `localStorage` è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå®é™…é¡¹ç›®ä¸­åº”è¯¥ï¼š
   - ä»ç™»å½•çŠ¶æ€è·å–
   - æˆ–é€šè¿‡ Token è§£æ
   - æˆ–ä»åç«¯ Session è·å–

2. **å•†å“æ¨¡å—ä¾èµ–**ï¼šè´­ç‰©è½¦æ¨¡å—ä¾èµ–å•†å“æ¨¡å—çš„ `ProductDao.getProductById` æ–¹æ³•ï¼Œç¡®ä¿ï¼š
   - å•†å“è¡¨å·²åˆ›å»º
   - `productmapper.xml` å·²é…ç½®
   - å•†å“æ•°æ®å·²åˆå§‹åŒ–

3. **æ•°æ®åº“é…ç½®**ï¼šç¡®ä¿ `application.yml` å’Œ `mybatis.xml` ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯æ­£ç¡®

4. **è·¨åŸŸé—®é¢˜**ï¼šå¦‚æœå‰ç«¯å’Œåç«¯è¿è¡Œåœ¨ä¸åŒç«¯å£ï¼Œéœ€è¦é…ç½® CORSï¼š
   ```java
   @CrossOrigin(origins = "http://localhost:5173")
   ```

## ğŸ”§ å¾…å®Œå–„åŠŸèƒ½

1. ç”¨æˆ·èº«ä»½éªŒè¯ï¼ˆToken/Sessionï¼‰
2. è´­ç‰©è½¦å›¾æ ‡æ•°é‡æ˜¾ç¤ºï¼ˆéœ€è¦åœ¨å¯¼èˆªæ ç»„ä»¶ä¸­é›†æˆï¼‰
3. å•†å“å›¾ç‰‡æ˜¾ç¤ºï¼ˆéœ€è¦å•†å“æ¨¡å—æä¾›å›¾ç‰‡URLï¼‰
4. è·¯ç”±è·³è½¬ï¼ˆå»ç»“ç®—ã€å»é€›é€›ç­‰åŠŸèƒ½ï¼‰
5. é”™è¯¯å¤„ç†ä¼˜åŒ–
6. åŠ è½½çŠ¶æ€ä¼˜åŒ–

## ğŸ“ å¼€å‘æ£€æŸ¥æ¸…å•

- [x] åç«¯å®ä½“ç±»åˆ›å»º
- [x] åç«¯ Repository å±‚
- [x] åç«¯ Service å±‚
- [x] åç«¯ Controller å±‚
- [x] MyBatis Mapper é…ç½®
- [x] å‰ç«¯ API å°è£…
- [x] å‰ç«¯ç»„ä»¶åˆ›å»º
- [x] å‰ç«¯é¡µé¢åˆ›å»º
- [x] è·¯ç”±é…ç½®
- [ ] é›†æˆæµ‹è¯•
- [ ] ç”¨æˆ·èº«ä»½éªŒè¯
- [ ] è´­ç‰©è½¦å›¾æ ‡æ•°é‡æ˜¾ç¤º

## ğŸ¤ ä¸å…¶ä»–æ¨¡å—çš„é›†æˆ

### ä¸å•†å“æ¨¡å—é›†æˆ

åœ¨å•†å“è¯¦æƒ…é¡µæ·»åŠ "åŠ å…¥è´­ç‰©è½¦"æŒ‰é’®ï¼š

```vue
<template>
  <button @click="handleAddToCart">åŠ å…¥è´­ç‰©è½¦</button>
</template>

<script setup>
import { addToCart } from '@/api/cart.js'

const handleAddToCart = async () => {
  const userId = getUserId() // è·å–å½“å‰ç”¨æˆ·ID
  const productId = product.value.productId
  const quantity = selectedQuantity.value
  
  try {
    const response = await addToCart(userId, productId, quantity)
    if (response.code === 200) {
      alert('æ·»åŠ æˆåŠŸ')
      // æ›´æ–°è´­ç‰©è½¦å›¾æ ‡æ•°é‡
    }
  } catch (error) {
    alert('æ·»åŠ å¤±è´¥')
  }
}
</script>
```

### ä¸è®¢å•æ¨¡å—é›†æˆ

åœ¨è´­ç‰©è½¦é¡µé¢ç‚¹å‡»"å»ç»“ç®—"æ—¶ï¼Œå°†é€‰ä¸­çš„å•†å“ä¼ é€’ç»™è®¢å•ç¡®è®¤é¡µã€‚

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è´­ç‰©è½¦æ¨¡å—å¼€å‘æŒ‡å—](./è´­ç‰©è½¦æ¨¡å—å¼€å‘æŒ‡å—.md)
- [éœ€æ±‚æ–‡æ¡£](../éœ€æ±‚æ–‡æ¡£.md)
- [æ¥å£æ–‡æ¡£](../æ¥å£æ–‡æ¡£.md)


